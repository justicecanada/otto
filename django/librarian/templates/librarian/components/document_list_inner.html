{% load i18n %}

<div id="librarian-document-list">
  {% if documents %}
    {% include "librarian/components/items_list.html" with items=documents selected_item=selected_document listbox_label="documents-label" item_type="document" %}
  {% else %}
    <div class="text-center">
      <em class="small">
        {% if selected_data_source and selected_data_source.chat_id %}
          {% trans "No documents in this chat." %}
        {% else %}
          {% trans "No documents in this folder." %}
        {% endif %}
      </em>
    </div>
  {% endif %}
</div>
<span id="librarian-failed-oob" hx-swap-oob="true">
  {% if blocked_count or failed_count %}
    <span class="small text-danger"
          role="img"
          data-bs-toggle="tooltip"
          data-bs-placement="bottom"
          data-bs-trigger="hover focus"
          title="{{ failed_count }} {% trans 'failed' %}{% if blocked_count %} · {{ blocked_count }} {% trans 'stopped' %}{% endif %}">
      <i class="bi bi-exclamation-circle-fill"></i>
    </span>
  {% endif %}
</span>
<span id="librarian-totals-oob" hx-swap-oob="true" class="d-none">
  <span id="librarian-total-cost">{{ total_cost|default:"$0.00" }}</span>
  <span id="librarian-total-chunks">{{ total_chunks|default:"0" }} {% trans "chunk(s)" %}</span>
  {% if failed_count %}
    · <span id="librarian-failed-count">{{ failed_count }}</span> {% trans "failed" %}
  {% endif %}
  {% if blocked_count %}
    · <span id="librarian-blocked-count">{{ blocked_count }}</span> {% trans "stopped" %}
  {% endif %}
</span>
<script>
document.body.addEventListener('htmx:afterSwap', function() {
  var el = document.querySelector('#librarian-failed-oob [data-bs-toggle="tooltip"]');
  if (el) {
    var inst = bootstrap.Tooltip.getInstance(el);
    if (inst) inst.dispose();
    new bootstrap.Tooltip(el);
  }
});
</script>
