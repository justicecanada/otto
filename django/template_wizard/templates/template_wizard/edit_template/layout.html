{% load i18n %}

<form class="g-3"
      id="edit_preset_form"
      method="post"
      url="{% url 'template_wizard:edit_layout' template_id=template.id %}">
  {% csrf_token %}
  <div class="row mb-2">
    <div class="col">
      <button type="button"
              class="btn btn-outline-secondary"
              id="insert-top-fields"
              onclick="insertFields(fields)">{% trans "Insert fields" %}</button>
    </div>
  </div>
  <div class="row">
    <div class="col">{{ layout_form }}</div>
  </div>
  <div class="row mt-3">
    <div class="col text-end">
      <button class="btn btn-primary" type="submit">
        {% trans "Save & next" %}<i class="bi bi-chevron-right ms-2"></i>
      </button>
    </div>
  </div>
</form>

<script>
const fieldSlugs = [{% for f in top_level_fields %}'{{ f.slug|escapejs }}'{% if not forloop.last %}, {% endif %}{% endfor %}];
const fieldNames = [{% for f in top_level_fields %}'{{ f.field_name|escapejs }}'{% if not forloop.last %}, {% endif %}{% endfor %}];
const fields = fieldSlugs.map((slug, index) => {
  return {
    slug: slug,
    name: fieldNames[index],
  };
});
</script>
