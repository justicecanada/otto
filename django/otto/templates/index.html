{% extends 'base.html' %}
{% load i18n %}
{% load static %}

{% block page_css %}
  <style>
  body {
    background: var(--bs-light);
    min-height: 100vh;
  }

  #start-tour, #contact-us {
    &:active {
      background-color: var(--bs-gray-300) !important;
      color: black;
    }
    
  }

  #help-button {
    &.btn {
      border-color: transparent !important;
    }
  }
  </style>
{% endblock %}

{% block body %}

  <h1 class="text-center display-3 fw-semibold">
    <img src="{% static 'otto-logo.png' %}"
         class="d-inline-block align-top"
         width="108"
         height="auto"
         id="otto-logo"
         alt="Smiling robot wearing Justice logo">
    <br>
    Otto
  </h1>
  <div class="lead fw-medium text-center">
    <p>{% trans "Empowering Justice efficiency with data and AI" %}</p>
  </div>

  <div class="my-5 alert alert-warning d-flex align-items-center"
       role="alert">
    <svg class="flex-shrink-0 bi me-2"
         width="24"
         height="24"
         role="img"
         aria-label="{% trans 'Warning:' %}">
      <use xlink:href="#exclamation-triangle-fill" />
    </svg>
    <div class="px-3">
      {% trans "Otto is in preview stage and is not intended to be used in legal proceedings. It is being evaluated by a select group of users at Department of Justice to assess potential risks and improve its safe use. Otto should not replace the advice of a qualified legal professional." %}
    </div>
  </div>

  <div id="app-list"
       class="{% if 'prod' in otto_version %}cols-2{% endif %}">
    {% for category in categorized_features %}
      <div class="app-category">
        <h2 class="fw-light h4 mb-3">{{ category.category_title }}</h2>
        {% for feature in category.features %}
          {% include 'components/feature_tile.html' %}
        {% endfor %}
        <div class="app-list-spacer mb-4"></div>
      </div>
    {% endfor %}
  </div>

  <div class="dropdown position-fixed bottom-0 end-0 m-3 bg-light rounded-circle">
    <button type="button"
            id="help-button"
            class="btn"
            title="{% trans 'Help' %}"
            data-bs-toggle="dropdown"
            aria-controls="help-menu"
            aria-haspopup="true"
            aria-expanded="false">
      <i class="bi bi-question-circle fs-5 text-muted"></i>
    </button>
    <ul id="help-menu"
        role="menu"
        class="dropdown-menu bg-light shadow"
        aria-labelledby="help-button">
      <li role="presentation">
        <button id="start-tour"
                role="menuitem"
                class="d-flex dropdown-item g-0 bg-light"
                onclick="driverObj.drive();">
          <div class="me-2">
            <i class="bi bi-airplane" style="font-size: .80rem;"></i>
          </div>
          {% trans 'Start a tour of Otto' %}
        </button>
      </li>
      <li role="presentation">
        <a id="contact-us"
           role="menuitem"
           class="d-flex dropdown-item g-0 bg-light"
           href="mailto:otto@justice.gc.ca">
          <div class="me-2">
            <i class="bi bi-envelope" style="font-size: .85rem"></i>
          </div>
        {% trans 'Contact us' %}</a>
      </li>
    </ul>
  </div>
{% endblock %}

{% block page_script %}
  <script>
      let driver =  window.driver.js.driver;
      let driverObj = driver({
        showProgress: true,
        popoverClass: "bs-popover-auto",
        prevBtnText: "{% trans 'Previous' %}",
        nextBtnText: "{% trans 'Next' %}",
        doneBtnText: "{% trans 'Done' %}",
        steps: [          
          { element: "#app-list", popover: { title: "{% trans 'Start using Otto'%}", description: "{% trans 'Start using Otto by selecting an application.'%}" } },
          { element: "#cost-bar-inner", popover: { title: "{% trans 'Cost allocation'%}", description: "{% trans 'This meter gradually fills up as you use Otto. It represents the amount of money left out of your weekly allocation. If you reach your limit, you will no longer be able to use Otto and will have to contact the Business Analytics Center to grant an exemption.'%}"} },
          { element: "#feedback-icon", popover: { title: "{% trans 'Feedback'%}", description: "{% trans 'Click on this icon to submit feedback about Otto. Let us know what went wrong, or suggest an improvement.'%}"} }
        ],
      });
  </script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const logoElement = document.querySelector('#otto-logo');
      // Make the logo bounce a bit when you click it
      logoElement.addEventListener('click', function() {
        logoElement.classList.add('animate');
        setTimeout(() => {
          logoElement.classList.remove('animate');
        }, 1000);
      });
    });
  </script>

{% endblock %}
