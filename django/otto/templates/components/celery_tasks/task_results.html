{% load i18n %}

{% if tasks %}
  <div class="table-responsive">
    <table class="table table-striped table-hover" id="task-table">
      <thead>
        <tr>
          <th>{% trans "Task Name" %}</th>
          <th>{% trans "Status" %}</th>
          <th>{% trans "Date" %}</th>
          <th>{% trans "Actions" %}</th>
        </tr>
      </thead>
      <tbody>
        {% for task in tasks %}
          <tr data-status="{{ task.status }}" data-task-name="{{ task.name }}">
            <td>{{ task.name }}</td>
            <td>
              {% if task.status == 'SUCCESS' %}
                <span class="badge bg-success">{{ task.status }}</span>
              {% elif task.status == 'FAILURE' %}
                <span class="badge bg-danger">{{ task.status }}</span>
              {% elif task.status == 'PENDING' %}
                <span class="badge bg-warning">{{ task.status }}</span>
              {% else %}
                <span class="badge bg-secondary">{{ task.status }}</span>
              {% endif %}
            </td>
            <td>{{ task.date_done }}</td>
            <td>
              <button type="button"
                      class="btn btn-sm btn-outline-primary"
                      data-bs-toggle="modal"
                      data-bs-target="#taskDetailModal{{ forloop.counter }}">{% trans "Details" %}</button>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <!-- Task detail modals -->
  {% for task in tasks %}
    {% include "components/celery_tasks/celery_task_details_modal.html" with task=task %}
  {% endfor %}

{% else %}
  <div class="alert alert-info">{% trans "No tasks found matching the current filters." %}</div>
{% endif %}
